---
title: "DevOps와 SE를 위한 리눅스 커널 이야기"
date: 2019-04-20T13:01:14+09:00

author: "Aidan.bae"
categories: ['Book']
tags: ['리눅스', '커널', 'devops']
noSummary: false
draft: false
---

게임 업계에서는 과거에 윈도우 서버가 90퍼를 차지했지만 최근에는 오픈소스인 리눅스 진영의 발전이 눈부시다. 특히 Docker서비스가 리눅스 기반으로 제작되면서
리눅스 커널에 대한 이해는 서버 운영자에게 필수 지식이 되었다.
 
 이 책은 카카오 클라우드팀에서 시스템 엔지니어로 근무중인 강진우님이 지으셨다. 브런치 블로그를 운영중인데 
실제 실무에서의 경험을 통해 좋은 글을 계속 게시해주고 계신다.  
https://brunch.co.kr/@alden#articles

아쉽게도 docker에 대한 이야기가 없어
docker로 서비스를 한다면 시스템 모니터링에 대한 부분이 좀 달라질 수 있지만
docker역시 pid를 리눅스로부터 부여받고 자원할당을 받기 때문에
호스트머신의 /proc 디렉토리에 접근해 다양한 정보를 확인하는 것은 상황에 따라 훌륭한 이슈트래킹 접근법이 될 수 있다.

리눅스 커널에는 수많은 파라미터들이 존재하는데 실무에서 조종하거나 컨트롤하는 커널 파라미터가 많지는 않다. 대부분 default값이 가장 좋은 경우가 많기 때문이다.  
그럼에도 불구하고 강진우님 (aiden)은 TCP 부하가 몰릴때,  메모리가 부족할 때 상황별로 확인해야할 커널 파라미터, 성능이나 시스템상 가장 중요한 튜닝 포인트가 되는 파라미터를 콕콕 찝어서 잘 설명해준다.

그리고 게임 서버를 운영하면서 적당히 알고간 정보들을 깊게 확인할 수 있게 해준다.
다음은 재밋게 본 파트와 느낀점 이다.

- 3장 Load Average와 시스템 부하

로드 에버리지는 DKOS(카카오 데이터센터)에서 자주 메트릭으로 확인한 정보인데, 딱히 뭔 의미있는 지표인지 무시하고 지나갔었다.  `top` 명령어를 칠때마다도 보이는 지표였다.
  

    - Load Average 값은 실행 혹은 실행 대기중 프로세스들의 수를 기반으로 만들어진다
    - 해당 값의 절대적인 높은 값과 낮음은 없다. 현재 시스템에 장착되어 있는 CPU코어 를 기반으로 상대적인 값으로 해석해야함
    - CPU Bound / IO Bound 의 구분
    
- 5장 Swap 메모리 증설의 포인트

리눅스에서 메모리 사용량을 확인하는 방법을 잘 설명해주고 있다. 메모리가 부족할 경우 어떤일이 벌어지는지에 대해 잘 설명해준다.  
swap영역은 물리 메모리가 부족할 경우 대비해서 만들어 놓은 영역이다. 비상용 메모리 공간이라고 생각하면 된다. 하지만 swap영역은 물리 메모리가 아니라 disk의 일부분을 메모리처럼 사용하기 위해 만들어 놓은 공간이기 때문에, 메모리가 부족할 때 사용한다고는 하지만 메모리에 비해
처리 속도와 접근이 현저히 느리다.
vm.swappiness, vm.vfs_cache_pressure 등 커널이 swap을 어떻게 대하는지에 대한 파라미터에 대한 설명이 잘되어 있다. 

이미 swap정도를 최소화 해놓은 dkos 리눅스 서버세팅(default = 60):
```shell
[deploy@dkos-snackgame-dev-slave-7 ~]$ sysctl vm.swappiness
vm.swappiness = 1
```

#### 마무리 
이 이외에도 애플리케이션의 성능 최적화,  TCP 소켓과 관련한 네트워크 IO 이야기등 흥미로운 이야기가 많다. 데브옵스 뿐만아니라 리눅스 기반의 서버개발을 하는 백엔드 엔지니어가 보아도 좋은 책이다. 강추!
  

